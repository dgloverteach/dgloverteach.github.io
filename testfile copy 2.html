<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enhanced Whiteboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #toolbar {
      margin: 10px;
      display: flex;
      gap: 10px;
    }
    #canvas {
      border: 1px solid #000;
      cursor: crosshair;
    }
  </style>
</head>
<body>

<h2>Enhanced Whiteboard</h2>
<div id="toolbar">
  <label>Brush Color:
    <input type="color" id="colorPicker" value="#000000">
  </label>
  <label>Brush Size:
    <input type="range" id="brushSize" min="1" max="20" value="5">
  </label>
  <label>Brush Type:
    <select id="brushType">
      <option value="round">Round</option>
      <option value="square">Square</option>
      <option value="diamond">Diamond</option>
    </select>
  </label>
  <input type="file" id="fileInput" accept="image/*,application/pdf">
  <button onclick="clearCanvas()">Clear</button>
  <button onclick="toggleEraser()">Toggle Eraser</button>
  <button onclick="saveCanvas()">Save</button>
</div>

<canvas id="canvas" width="800" height="600"></canvas>

<script>
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");

  let painting = false;
  let eraser = false;
  let brushColor = document.getElementById("colorPicker").value;
  let brushSize = document.getElementById("brushSize").value;
  let brushType = document.getElementById("brushType").value;

  // Event listeners for drawing
  canvas.addEventListener("mousedown", startPainting);
  canvas.addEventListener("mouseup", stopPainting);
  canvas.addEventListener("mousemove", draw);
  canvas.addEventListener("mouseleave", stopPainting);

  // Touch support
  canvas.addEventListener("touchstart", startPainting);
  canvas.addEventListener("touchend", stopPainting);
  canvas.addEventListener("touchmove", draw);

  // Toolbar controls
  document.getElementById("colorPicker").addEventListener("input", (e) => {
    brushColor = e.target.value;
  });

  document.getElementById("brushSize").addEventListener("input", (e) => {
    brushSize = e.target.value;
  });

  document.getElementById("brushType").addEventListener("change", (e) => {
    brushType = e.target.value;
  });

  // File input for image/PDF
  document.getElementById("fileInput").addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file && file.type.startsWith("image")) {
      loadImage(file);
    } else if (file && file.type === "application/pdf") {
      alert("PDF functionality requires pdf.js integration.");
      // Placeholder for PDF functionality
      // You would need pdf.js here to render PDF on canvas.
    }
  });

  function startPainting(e) {
    painting = true;
    draw(e);
  }

  function stopPainting() {
    painting = false;
    ctx.beginPath();
  }

  function draw(e) {
    e.preventDefault(); // Prevent scrolling on touch devices

    if (!painting) return;

    ctx.lineWidth = brushSize;
    ctx.lineCap = brushType;
    ctx.strokeStyle = eraser ? "#ffffff" : brushColor;

    const x = e.clientX || e.touches[0].clientX;
    const y = e.clientY || e.touches[0].clientY;

    ctx.lineTo(x - canvas.offsetLeft, y - canvas.offsetTop);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(x - canvas.offsetLeft, y - canvas.offsetTop);
  }

  function clearCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  function toggleEraser() {
    eraser = !eraser;
  }

  function saveCanvas() {
    const link = document.createElement("a");
    link.download = "whiteboard.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
  }

  function loadImage(file) {
    const img = new Image();
    img.onload = () => {
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    };
    img.src = URL.createObjectURL(file);
  }
</script>

</body>
</html>
